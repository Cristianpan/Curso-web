(()=>{document.querySelector("#add-task").addEventListener("click",()=>{t()});let e=[];function t(t=!1,c={nombre:"",descripcion:""}){const i=document.createElement("DIV");i.classList.add("modal"),i.innerHTML=`\n            <form class="form new-task">\n                <legend>${t?"Editar Tarea":"Agregar Tarea"}</legend>\n                <div class="field">\n                    <label for="task">Tarea</label>\n                    <input type="text" name="task" placeholder="Nombre de la tarea" id="task" value="${c.nombre}"/>\n                </div>\n                <div class="field">\n                    <label for="description">Descripcion</label>\n                    <textarea id="description" name="description" placeholder="Descripción de la tarea">${c.descripcion}</textarea>\n                </div>\n\n                <div class="options aling-right">\n                    <button type="button" class="close-modal">Cancelar</button>\n                    <input type="submit" class="submit-new-task" value="Guardar Tarea"/>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".form").classList.add("animar")},0),i.addEventListener("click",d=>{d.preventDefault();const r=d.target.classList;if(r.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{i.remove()},200)}else r.contains("submit-new-task")&&function(t,c){const i=document.querySelector("#task").value.trim(),d=document.querySelector("#description").value.trim();c={...c,nombre:i,descripcion:d},i?t?s(c):async function(t){const{nombre:s,descripcion:c}=t,i={nombre:s,descripcion:c,proyectoId:o()};try{const t=await fetch("/api/crearTarea",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}),o=await t.json();o.ok?(e=[...e,o.body],n(o.message,"legend","exito"),setTimeout(()=>{document.querySelector(".modal").remove(),function(e){const t=document.querySelector("#task-list"),n=a(e);t.appendChild(n)}(o.body)},1e3)):n(o.message,"legend")}catch(e){console.log(e)}}(c):n("El nombre de la tarea es obligatorio","legend")}(t,c)}),document.querySelector(".dashboard").appendChild(i)}function n(e,t,n="error"){const a=document.querySelector(t),o=document.createElement("DIV");o.classList.add(n),o.classList.add("alert");const s=document.createElement("P");s.textContent=e,o.appendChild(s),a.after(o),setTimeout(()=>{o.remove()},1200)}function a(a){const o={0:"Pendiente",1:"Completa"},c=document.createElement("LI");c.id=a.id,c.classList.add("task");const i=document.createElement("P");i.innerHTML="&#10148; "+a.nombre;const d=document.createElement("P");d.classList.add("description"),d.textContent=a.descripcion;const r=document.createElement("DIV");r.classList.add("options");const l=document.createElement("BUTTON");l.classList.add("state-task"),l.classList.add(""+o[a.estado].toLowerCase()),l.textContent=o[a.estado],l.ondblclick=async()=>{await async function(e){const t={...e};t.estado=1===t.estado?0:1,await s(t)&&(e.estado=1===e.estado?0:1)}(a)};const m=document.createElement("BUTTON");m.classList.add("delete-task"),m.textContent="Eliminar",m.ondblclick=()=>{!async function(t){(await Swal.fire({title:"¿Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"})).isConfirmed&&async function(t){const a=await fetch("/api/eliminarTarea",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),o=await a.json(),s=o.ok?"exito":"error";n(o.message,".nombre-pagina",s),o.ok&&(e=e.filter(e=>{e.id,t.id}),c=t.id,document.getElementById(c).remove());var c}(t)}(a)};const u=document.createElement("BUTTON");u.classList.add("edit-task"),u.ondblclick=()=>{t(!0,a)},u.textContent="Editar",r.appendChild(l),r.appendChild(u),r.appendChild(m);const p=document.createElement("SUMMARY");p.appendChild(i),p.appendChild(r);const y=document.createElement("DETAILS");return y.classList.add("details-task"),y.appendChild(p),y.appendChild(d),c.appendChild(y),c}function o(){return new URLSearchParams(window.location.search).get("token")}async function s(t){let a=!1;try{const o=await fetch("/api/actualizarTarea",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),s=await o.json(),c=s.ok?"exito":"error";s.ok&&(e=e.map(e=>(e.id===t.id&&(e={...t}),e)),setTimeout(()=>{document.querySelector(".modal").remove()},500),setTimeout(()=>{n(s.message,".nombre-pagina",c),function(e){const t={0:"Pendiente",1:"Completa"},n=document.getElementById(e.id);n.querySelector("summary p").innerHTML="&#10148; "+e.nombre;const a=n.querySelector(".state-task");a.textContent=t[e.estado],1===e.estado?a.classList.remove("pendiente"):a.classList.remove("completa"),a.classList.add(t[e.estado].toLowerCase());n.querySelector(".description").textContent=e.descripcion}(t)},600),a=!0)}catch(e){console.log(e)}return a}!async function(){const t="/api/tareas?id="+o();try{const n=await fetch(t),o=await n.json();e=o.body,function(e){const t=document.querySelector("#task-list");if(0===e.length){const e=document.createElement("LI");e.innerHTML="<p>No Hay Tareas</p>",e.classList.add("no-tasks"),t.appendChild(e)}else{const n=document.createDocumentFragment();e.forEach(e=>{const t=a(e);n.appendChild(t)}),t.appendChild(n)}}(e)}catch(e){console.log(e)}}()})();