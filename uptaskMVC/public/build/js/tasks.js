(()=>{let e=[];!async function(){const t="/api/tareas?id="+s();try{const n=await fetch(t),a=await n.json();e=a.body,c(e)}catch(e){console.log(e)}}();document.querySelector("#add-task").addEventListener("click",()=>{n()});function t(t){const n=t.target.value;let a=[...e];n&&(a=a.filter(e=>e.estado==n)),function(){const e=document.querySelector("#task-list");for(;e.firstChild;)e.removeChild(e.firstChild)}(),c(a)}function n(t=!1,n={nombre:"",descripcion:""}){const c=document.createElement("DIV");c.classList.add("modal"),c.innerHTML=`\n            <form class="form new-task">\n                <legend>${t?"Editar Tarea":"Agregar Tarea"}</legend>\n                <div class="field">\n                    <label for="task">Tarea</label>\n                    <input type="text" name="task" placeholder="Nombre de la tarea" id="task" value="${n.nombre}"/>\n                </div>\n                <div class="field">\n                    <label for="description">Descripcion</label>\n                    <textarea id="description" name="description" placeholder="Descripción de la tarea">${n.descripcion}</textarea>\n                </div>\n\n                <div class="options">\n                    <button type="button" class="close-modal">Cancelar</button>\n                    <input type="submit" class="submit-new-task" value="Guardar Tarea"/>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".form").classList.add("animar")},0),c.addEventListener("click",d=>{d.preventDefault();const r=d.target.classList;if(r.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{c.remove()},200)}else r.contains("submit-new-task")&&function(t,n){const c=document.querySelector("#task").value.trim(),d=document.querySelector("#description").value.trim();n={...n,nombre:c,descripcion:d},c?t?i(n):async function(t){const{nombre:n,descripcion:c}=t,i={nombre:n,descripcion:c,proyectoId:s()};try{const t=await fetch("/api/crearTarea",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}),n=await t.json();n.ok?(e=[...e,n.body],a(n.message,"legend","exito"),setTimeout(()=>{document.querySelector(".modal").remove(),function(e){const t=document.querySelector("#task-list"),n=o(e);t.appendChild(n)}(n.body)},1e3)):a(n.message,"legend")}catch(e){console.log(e)}}(n):a("El nombre de la tarea es obligatorio","legend")}(t,n)}),document.querySelector(".dashboard").appendChild(c)}function a(e,t,n="error"){const a=document.querySelector(t);if(a){const t=document.createElement("DIV");t.classList.add(n),t.classList.add("alert");const o=document.createElement("P");o.textContent=e,t.appendChild(o),a.after(t),setTimeout(()=>{t.remove()},1200)}}function o(t){const o={0:"Pendiente",1:"Completa"},s=document.createElement("LI");s.id=t.id,s.classList.add("task");const c=document.createElement("P");c.innerHTML="&#10148; "+t.nombre;const d=document.createElement("P");d.classList.add("description"),d.textContent=t.descripcion;const r=document.createElement("DIV");r.classList.add("options");const l=document.createElement("BUTTON");l.classList.add("state-task"),l.classList.add(""+o[t.estado].toLowerCase()),l.textContent=o[t.estado],l.ondblclick=async()=>{await async function(e){const t={...e};t.estado=1===t.estado?0:1,await i(t)&&(e.estado=1===e.estado?0:1)}(t)};const m=document.createElement("BUTTON");m.classList.add("delete-task"),m.textContent="Eliminar",m.ondblclick=()=>{!async function(t){(await Swal.fire({title:"¿Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"})).isConfirmed&&async function(t){const n=await fetch("/api/eliminarTarea",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),o=await n.json(),s=o.ok?"exito":"error";a(o.message,".nombre-pagina",s),o.ok&&(e=e.filter(e=>{e.id,t.id}),c=t.id,document.getElementById(c).remove());var c}(t)}(t)};const u=document.createElement("BUTTON");u.classList.add("edit-task"),u.ondblclick=()=>{n(!0,t)},u.textContent="Editar",r.appendChild(l),r.appendChild(u),r.appendChild(m);const p=document.createElement("SUMMARY");p.appendChild(c),p.appendChild(r);const f=document.createElement("DETAILS");return f.classList.add("details-task"),f.appendChild(p),f.appendChild(d),s.appendChild(f),s}function s(){return new URLSearchParams(window.location.search).get("token")}function c(e){const t=document.querySelector("#task-list");if(0===e.length){const e=document.createElement("LI");e.innerHTML="<p>No Hay Tareas</p>",e.classList.add("no-tasks"),t.appendChild(e)}else{const n=document.createDocumentFragment();e.forEach(e=>{const t=o(e);n.appendChild(t)}),t.appendChild(n)}}async function i(t){let n=!1;try{const o=await fetch("/api/actualizarTarea",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),s=await o.json(),c=s.ok?"exito":"error";a(s.message,"legend",c),s.ok&&(e=e.map(e=>(e.id===t.id&&(e={...t}),e)),setTimeout(()=>{const e=document.querySelector(".modal");e&&e.remove()},1e3),function(e){const t={0:"Pendiente",1:"Completa"},n=document.getElementById(e.id);n.querySelector("summary p").innerHTML="&#10148; "+e.nombre;const a=n.querySelector(".state-task");a.textContent=t[e.estado],1===e.estado?a.classList.remove("pendiente"):a.classList.remove("completa"),a.classList.add(t[e.estado].toLowerCase());n.querySelector(".description").textContent=e.descripcion}(t),n=!0)}catch(e){console.log(e)}return n}document.querySelectorAll("#filters input[type='radio']").forEach(e=>{e.addEventListener("input",t)})})();