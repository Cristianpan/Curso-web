(()=>{let e=[];!async function(){const t="/api/tareas?id="+s();try{const n=await fetch(t),o=await n.json();e=o.body,c(e)}catch(e){console.log(e)}}();document.querySelector("#add-task").addEventListener("click",()=>{n()});function t(t){const n=t.target.value;let o=[...e];n&&(o=o.filter(e=>e.estado==n)),function(){const e=document.querySelector("#task-list");for(;e.firstChild;)e.removeChild(e.firstChild)}(),c(o)}function n(t=!1,n={nombre:"",descripcion:""}){const c=document.createElement("DIV");c.classList.add("modal"),c.innerHTML=`\n            <form class="form new-task">\n                <legend>${t?"Editar Tarea":"Agregar Tarea"}</legend>\n                <div class="field">\n                    <label for="task">Tarea</label>\n                    <input type="text" name="task" placeholder="Nombre de la tarea" id="task" value="${n.nombre}"/>\n                </div>\n                <div class="field">\n                    <label for="description">Descripcion</label>\n                    <textarea id="description" name="description" placeholder="Descripción de la tarea">${n.descripcion}</textarea>\n                </div>\n\n                <div class="options">\n                    <button type="button" class="close-modal">Cancelar</button>\n                    <input type="submit" class="submit-new-task" value="Guardar Tarea"/>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".form").classList.add("animar")},0),c.addEventListener("click",d=>{d.preventDefault();const r=d.target.classList;if(r.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{c.remove()},200)}else r.contains("submit-new-task")&&function(t,n){const c=document.querySelector("#task").value.trim(),d=document.querySelector("#description").value.trim();n={...n,nombre:c,descripcion:d},c?t?i(n):async function(t){const{nombre:n,descripcion:c}=t,i={nombre:n,descripcion:c,proyectoId:s()};try{const t=await fetch("/api/crearTarea",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}),n=await t.json();n.ok?(e=[...e,n.body],o(n.message,"legend","exito"),setTimeout(()=>{document.querySelector(".modal").remove(),function(t){1===e.length&&document.querySelector(".no-tasks").remove();const n=document.querySelector("#task-list"),o=a(t);n.appendChild(o)}(n.body)},1e3)):o(n.message,"legend")}catch(e){console.log(e)}}(n):o("El nombre de la tarea es obligatorio","legend")}(t,n)}),document.querySelector(".dashboard").appendChild(c)}function o(e,t,n="error"){const o=document.querySelector(t);if(o){const t=document.createElement("DIV");t.classList.add(n),t.classList.add("alert");const a=document.createElement("P");a.textContent=e,t.appendChild(a),o.after(t),setTimeout(()=>{t.remove()},1200)}}function a(t){const a={0:"Pendiente",1:"Completa"},s=document.createElement("LI");s.id=t.id,s.classList.add("task");const d=document.createElement("P");d.innerHTML="&#10148; "+t.nombre;const r=document.createElement("P");r.classList.add("description"),r.textContent=t.descripcion;const l=document.createElement("DIV");l.classList.add("options");const m=document.createElement("BUTTON");m.classList.add("state-task"),m.classList.add(""+a[t.estado].toLowerCase()),m.textContent=a[t.estado],m.ondblclick=async()=>{await async function(e){const t={...e};t.estado=1===t.estado?0:1,await i(t)&&(e.estado=1===e.estado?0:1)}(t)};const u=document.createElement("BUTTON");u.classList.add("delete-task"),u.textContent="Eliminar",u.ondblclick=()=>{!async function(t){(await Swal.fire({title:"¿Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"})).isConfirmed&&async function(t){const n=await fetch("/api/eliminarTarea",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),a=await n.json(),s=a.ok?"exito":"error";o(a.message,".nombre-pagina",s),a.ok&&(e=e.filter(e=>e.id!==t.id),i=t.id,document.getElementById(i).remove(),0===e.length&&c(e));var i}(t)}(t)};const p=document.createElement("BUTTON");p.classList.add("edit-task"),p.ondblclick=()=>{n(!0,t)},p.textContent="Editar",l.appendChild(m),l.appendChild(p),l.appendChild(u);const f=document.createElement("SUMMARY");f.appendChild(d),f.appendChild(l);const y=document.createElement("DETAILS");return y.classList.add("details-task"),y.appendChild(f),y.appendChild(r),s.appendChild(y),s}function s(){return new URLSearchParams(window.location.search).get("token")}function c(e){const t=document.querySelector("#task-list");if(0===e.length){const e=document.createElement("LI");e.innerHTML="<p>No Hay Tareas</p>",e.classList.add("no-tasks"),t.appendChild(e)}else{const n=document.createDocumentFragment();e.forEach(e=>{const t=a(e);n.appendChild(t)}),t.appendChild(n)}}async function i(t){let n=!1;try{const a=await fetch("/api/actualizarTarea",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),s=await a.json(),c=s.ok?"exito":"error";o(s.message,"legend",c),s.ok&&(e=e.map(e=>(e.id===t.id&&(e={...t}),e)),setTimeout(()=>{const e=document.querySelector(".modal");e&&e.remove()},1e3),function(e){const t={0:"Pendiente",1:"Completa"},n=document.getElementById(e.id);n.querySelector("summary p").innerHTML="&#10148; "+e.nombre;const o=n.querySelector(".state-task");o.textContent=t[e.estado],1===e.estado?o.classList.remove("pendiente"):o.classList.remove("completa"),o.classList.add(t[e.estado].toLowerCase());n.querySelector(".description").textContent=e.descripcion}(t),n=!0)}catch(e){console.log(e)}return n}document.querySelectorAll("#filters input[type='radio']").forEach(e=>{e.addEventListener("input",t)})})();